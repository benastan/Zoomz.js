// Generated by CoffeeScript 1.3.1
(function() {
  var data, file, files, first, fs, haml, http, media_url, path, port, settings, _i, _len;

  haml = require('haml');

  fs = require('fs');

  path = require('path');

  http = require('http');

  files = ['basic'];

  data = {};

  media_url = process.argv[2];

  port = parseInt(process.argv[3], 10);

  if (process.argv.length < 3 && path.existsSync('build.config')) {
    settings = JSON.parse(fs.readFileSync('build.config', 'utf-8'));
    media_url = setting[0];
    port = parseInt(settings[1], 10);
  }

  if (media_url === void 0) {
    media_url = '';
  }

  for (_i = 0, _len = files.length; _i < _len; _i++) {
    file = files[_i];
    data[file] = haml(fs.readFileSync('tpl/' + file + '.haml', 'utf-8'))({
      media_url: media_url
    });
    fs.writeFileSync('../examples/' + file + '.html', data[file], 0, 'utf-8');
    if (!first) {
      first = data[file];
    }
  }

  if (port) {
    http.createServer(function(q, s) {
      var filename, uri;
      uri = q.url.substr(1);
      if (data[uri]) {
        return s.end(data[uri]);
      } else {
        filename = '../examples/' + uri;
        if (path.existsSync(filename)) {
          return s.end(fs.readFileSync(filename));
        }
      }
    }).listen(port);
    console.log('Examples running on port ' + port);
  }

}).call(this);
